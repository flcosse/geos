<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="auteur" content="">
<link rel="icon" href="imagr/planet-earth.png">
<title>Scripts annexes</title>
<!-- Bootstrap core CSS -->
<link href="assets/css/bootstrap.min.css" rel="stylesheet">
<!-- Fonts -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
<!-- Custom styles for this template -->
<link href="assets/css/mediumish.css" rel="stylesheet">
</head>
<body>
    <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
	
		
	</body>

<!-- Begin Nav
================================================== -->
<nav class="navbar navbar-toggleable-md navbar-light bg-white fixed-top mediumnavigation">
<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>
</button>
<div class="container">
	<!-- Begin Logo -->
	<a class="navbar-brand" href="index.html">
	
	</a>
	<!-- End Logo -->
	<div class="collapse navbar-collapse" id="navbarsExampleDefault">
		<!-- Begin Menu -->
        <a class="navbar-brand" href="index.html">
            <img src="imagr/planet-earth.png" alt="logo">
            </a>
		<ul class="navbar-nav ml-auto">
            
			<li class="nav-item active">
			<a class="nav-link" href="index.html">Accueil <span class="sr-only">(current)</span></a>
			</li>
			
			
		</ul>
		<!-- End Menu -->
		<!-- Begin Search -->
		<form class="form-inline my-2 my-lg-0">
			<input class="form-control mr-sm-2" type="text" placeholder="Search">
			<span class="search-icon"><svg class="svgIcon-use" width="25" height="25" viewbox="0 0 25 25"><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"></path></svg></span>
		</form>
		<!-- End Search -->
	</div>
</div>
</nav>
<!-- End Nav
================================================== -->

<!-- Begin Article
================================================== -->
<div class="container">
	<div class="row">

		<!-- Begin Fixed Left Share -->
		<div class="col-md-2 col-xs-12">
			<div class="share">
				
			</div>
		</div>
		<!-- End Fixed Left Share -->

		<!-- Begin Post -->
		<div class="col-md-8 col-md-offset-2 col-xs-12">
			<div class="mainheading">

				<!-- Begin Top Meta -->
				
				<!-- End Top Menta -->

				<h1 class="posttitle">Webmapping et points reliés par des lignes</h1>
					
			</div>
			<div class="after-post-tags">
				<ul class="tags">
					<li><a href="#">Python</a></li>
					<li><a href="#">PyQGIS</a></li>
					<li><a href="#">qgis2web</a></li>
					<li><a href="#">Leaflet</a></li>
				</ul>
			</div>

			<!-- Begin Featured Image -->
            <p>
                La carte ci-dessous montre les flux des travailleurs pontacquais dans leurs bassins d'emplois. Les données issus de l'INSEE sont traités par un graphique qui relie des points entre eux par une ligne pour générer une carte à oursin.<br>L'extension qgis2web fournit les fichiers pour créer la webmap. Quelques modifications sont faites dans le fichier .js.
            </p>
<style>
	
</style>
			<!-- Begin Featured Image --><h5></h3>
			<iframe src="QGIS/index.html"scrolling="no"frameBorder="0" height="70%" width="170%" title="Carte 1" style="margin-left: -35%;"></iframe><br><br>
<pre class="line-numbers"><code class="python">uri = r"C:\Users\Florian\Pictures\TERRITOIRE\fin.shp|layername=fin"
layer = QgsVectorLayer(uri,"points","ogr")
point = QgsVectorLayer(r"C:\Users\Florian\Pictures\TERRITOIRE\PONTAVQ.shp|layername=PONTAVQ","","ogr")

for f in point.getFeatures():
    geom1 = f.geometry()
    X = geom1.asPoint().x()
    Y = geom1.asPoint().y()
    
scr = iface.mapCanvas().mapSettings().destinationCrs().authid()
kek = scr.split(":")
X1 = []
Y1 = []

for i in layer.getFeatures():
    geom = i.geometry()
    X1.append(geom.asPoint().x())
    Y1.append(geom.asPoint().y())

for i,j in zip(X1,Y1):
    start_point = QgsPoint(X,Y)
    end_point = QgsPoint(i, j)
    v_layer = QgsVectorLayer('LineString?crs='+scr.lower(), 'line', 'memory')
    pr = v_layer.dataProvider()
    seg = QgsFeature()
    seg.setGeometry(QgsGeometry.fromPolyline([start_point, end_point]))
    pr.addFeatures([ seg ])
    QgsProject.instance().addMapLayers([v_layer])

listLayers = QgsProject.instance().mapLayersByName('line')
output = "C:/Users/Florian/Desktop/Lignes.shp"
processing.runAndLoadResults("native:mergevectorlayers", 
                             {'LAYERS':listLayers,
                             'CRS':kek[1],
                             'OUTPUT':output})
                             
layers = QgsProject.instance().mapLayers()

for i in layers.values():
    QgsProject.instance().removeMapLayers([i.id()])

iface.addVectorLayer(output,"","ogr")
iface.addVectorLayer(uri,"","ogr")
</code></pre>
			<!-- Begin Post Content -->
<br>

 	<!-- End Post Content -->

			<!-- Begin Tags -->

			<!-- End Tags -->

		</div>
		<!-- End Post -->

	</div>
</div>
<!-- End Article
================================================== -->



<!-- Begin Related
================================================== -->


<!-- Begin Twitter Timeline
================================================== -->

<!-- End Twitter Timeline
================================================== -->

<!-- Begin AlertBar
================================================== -->

<!-- End AlertBar
================================================== -->

<!-- Begin Footer
================================================== -->
<!-- End Footer
================================================== -->

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="assets/js/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/ie10-viewport-bug-workaround.js"></script>
<script src="assets/js/mediumish.js"></script>
</body>
</html>
